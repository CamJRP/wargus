#!/bin/sh
# postinst script for wargus
#
# see: dh_installdeb(1)

set -e

# Source debconf library
. /usr/share/debconf/confmodule

case "$1" in
  configure)
      db_get shared/warguscdpath || true
      CDPATH=${RET}
      EXTRACTVIDEO=
      EXTRACTMUSIC=
      if [ -d "${CDPATH}" ]; then
        db_get shared/wargusextractvideo || true
        if [ ${RET} = "true" ]; then
          EXTRACTVIDEO="-v"
        fi
        db_get shared/wargusextractmusic || true
        if [ ${RET} = "true" ]; then
          EXTRACTMUSIC="-v"
        fi
        echo "Extracting data from ${CDPATH} to /usr/share/games/stratagus/wargus"
        /usr/share/games/stratagus/wargus/build.sh -p ${CDPATH} -o /usr/share/games/stratagus/wargus -c ${EXTRACTVIDEO} ${EXTRACTMUSIC}
      else
        echo "${RET} doesn't exist - can't extract WarCraft II data" >&2
        exit 1
      fi
  ;;
  *)
    echo "postinst called with unknown argument \`$1'" >&2
    exit 1
  ;;
esac

db_stop || true

# dh_installdeb will replace this with shell code automatically
# generated by other debhelper scripts.

#DEBHELPER#

exit 0
